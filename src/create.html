<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>C-Combos</title>
    <link rel="stylesheet" href="styles/create.css">
</head>
<body>
    <header>
            <h1><a href="../index.html">C-Combos</a></h1>
            <ul>
                <li><a href="#">Criar</a></li>
                <li><a href="https://discord.gg/W2qRssup8a" target="_blank">Discord</a></li>
                <li><a href="https://github.com/developerferreira" target="_blank">Github</a></li>
            </ul>
    </header>

    <main>
        <input type="text" id="search" placeholder="Pesquise pela sua skin">
        <select name="user-item" id="user-item"></select>
        <img src="#" alt="#" id="img">
    </main>

    <script>
        const userItem = document.querySelector('#user-item')
        const searchInput = document.querySelector("#search")
        const img = document.querySelector("#img")

        fetch('data/skins.json')
            .then(response => response.json())
            .then(items => {
                const itemValue = Object.keys(items)
                const opt = document.createElement('option')
                searchInput.addEventListener('input', handleSearch)
                
                /*
                itemValue.forEach(item => {
                    const opt = document.createElement('option')
                    opt.textContent = item
                    userItem.appendChild(opt)
                })

                userItem.appendChild(opt)*/

                function handleSearch() {
                    const searchTxt = searchInput.value.toLowerCase()
                    // const filtredKeys = itemValue.filter(itemValue => itemValue.toLowerCase().includes(searchTxt))
                    const filtredKeys = searchTxt ? itemValue.filter(item => item.toLowerCase().includes(searchTxt)) : itemValue

                    userItem.innerHTML = ''

                    filtredKeys.forEach(key => {
                        const opt = document.createElement('option')
                        opt.textContent = key
                        opt.value = key
                        userItem.appendChild(opt)
                    })
                }

                handleSearch()

                userItem.addEventListener('change', () => {
                    const selectedKey = userItem.value
                    const selectedItem = items[selectedKey]

                    if (selectedItem?.glove) {
                        img.src = selectedItem.glove
                    } else {
                        img.src = 'imgs/default.png'
                    }
                })
            })
    </script>
</body>
</html>